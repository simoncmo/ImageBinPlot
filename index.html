<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>ImageBinPlot • ImageBinPlot</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="ImageBinPlot">
<meta name="description" content="A Simple R function for binning and visualizing spatial transcriptomics data from Seurat objects. This utility supports both cell-based expression data and molecule-based transcript counts, with optional identity overlays using scattermore. Designed for Xenium data but adaptable to other spatial datasets.">
<meta property="og:description" content="A Simple R function for binning and visualizing spatial transcriptomics data from Seurat objects. This utility supports both cell-based expression data and molecule-based transcript counts, with optional identity overlays using scattermore. Designed for Xenium data but adaptable to other spatial datasets.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ImageBinPlot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.0000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="imagebinplot">ImageBinPlot<a class="anchor" aria-label="anchor" href="#imagebinplot"></a>
</h1></div>
<p>A Simple R function for binning and visualizing spatial transcriptomics data from Seurat objects. This utility supports both cell-based expression data and molecule-based transcript counts, with optional identity overlays using <code>scattermore</code>. Designed for Xenium data but adaptable to other spatial datasets.</p>
<div class="section level2">
<h2 id="features">Features<a class="anchor" aria-label="anchor" href="#features"></a>
</h2>
<ul>
<li>
<strong>Binning</strong>: Aggregate spatial data into grids with customizable bin sizes.</li>
<li>
<strong>Visualization</strong>: Generate raster plots using <code>ggplot2</code> with the <code>viridis</code> color scale.</li>
<li>
<strong>Data Types</strong>: Supports two modes:
<ul>
<li>
<code>expression</code>: For cell-level transcript counts.</li>
<li>
<code>molecule</code>: For individual transcript coordinates.</li>
</ul>
</li>
<li>
<strong>Identity Overlay</strong>: Optionally overlay cell identities (e.g., clusters) using <code>geom_scattermore</code>.</li>
<li>
<strong>Multiple Fields of View</strong>: Use <code>ImageBinPlotFOVs</code> to generate plots for multiple FOVs with optional same-scale adjustment.</li>
<li>
<strong>Multi-Object Plotting</strong>: Use <code>ImageBinPlotObjects</code> to visualize spatial data across multiple Seurat objects.</li>
<li>
<strong>Customization</strong>: Adjust bin size, color scaling, transparency, and layer order.</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<ol style="list-style-type: decimal">
<li>
<p><strong>Clone the Repository</strong>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/simoncmo/ImageBinPlot.git</span></code></pre></div>
</li>
<li>
<p><strong>Source the Script</strong>: In your R session, source the script:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">"ImageBinPlot.R"</span><span class="op">)</span></span></code></pre></div>
</li>
</ol>
</div>
<div class="section level2">
<h2 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h2>
<p>Install the required R packages:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tidyverse"</span>, <span class="st">"Seurat"</span>, <span class="st">"ggplot2"</span>, <span class="st">"glue"</span>, <span class="st">"scattermore"</span>, <span class="st">"viridis"</span>, <span class="st">"patchwork"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code>tidyverse</code>: For data manipulation and visualization.</li>
<li>
<code>Seurat</code>: For handling spatial transcriptomics data.</li>
<li>
<code>ggplot2</code>: For plotting.</li>
<li>
<code>glue</code>: For string interpolation.</li>
<li>
<code>scattermore</code>: For efficient scatter plot overlays.</li>
<li>
<code>viridis</code>: Provides color palettes.</li>
<li>
<code>patchwork</code>: For combining multiple plots.</li>
</ul>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="section level3">
<h3 id="basic-setup">Basic Setup<a class="anchor" aria-label="anchor" href="#basic-setup"></a>
</h3>
<p>Load your Seurat object and source the script:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"/path/to/your_seurat_object.rds"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/qsbase/qs" class="external-link">qs</a></span><span class="op">)</span>  <span class="co"># Optional if using .qs files</span></span>
<span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu">qread</span><span class="op">(</span><span class="st">"/path/to/your_seurat_object.qs"</span>, nthreads <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">"ImageBinPlot.R"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-1-expression-based-binning">Example 1: Expression-Based Binning<a class="anchor" aria-label="anchor" href="#example-1-expression-based-binning"></a>
</h3>
<p>Plot binned expression data for a gene using <code>ImageBinPlot</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot expression of "EPCAM" with 10µm bins</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ImageBinPlot</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>, </span>
<span>  feature <span class="op">=</span> <span class="st">"EPCAM"</span>, </span>
<span>  bin_size <span class="op">=</span> <span class="fl">10</span>,  <span class="co"># in µm</span></span>
<span>  max_quantile <span class="op">=</span> <span class="st">"q75"</span>, </span>
<span>  type <span class="op">=</span> <span class="st">"expression"</span>,</span>
<span>  <span class="co"># palette from viridis</span></span>
<span>  palette <span class="op">=</span> <span class="st">'viridis'</span>, <span class="co"># c('viridis', 'inferno', 'magma', 'plasma','cividis','mako','rocket','turbo')</span></span>
<span>  palette_begin <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  palette_end <span class="op">=</span> <span class="fl">1</span>,</span>
<span><span class="op">)</span></span>
<span><span class="fu">ggsave</span><span class="op">(</span><span class="st">"EPCAM_expression.pdf"</span>, <span class="va">p</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-2-molecule-based-binning">Example 2: Molecule-Based Binning<a class="anchor" aria-label="anchor" href="#example-2-molecule-based-binning"></a>
</h3>
<p>Plot binned transcript counts for a gene:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot molecule counts for "TP63" with 10µm bins</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ImageBinPlot</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>, </span>
<span>  feature <span class="op">=</span> <span class="st">"TP63"</span>, </span>
<span>  bin_size <span class="op">=</span> <span class="fl">10</span>, </span>
<span>  max_quantile <span class="op">=</span> <span class="st">"q75"</span>, </span>
<span>  type <span class="op">=</span> <span class="st">"molecule"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">ggsave</span><span class="op">(</span><span class="st">"TP63_molecules.pdf"</span>, <span class="va">p</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-3-with-identity-overlay">Example 3: With Identity Overlay<a class="anchor" aria-label="anchor" href="#example-3-with-identity-overlay"></a>
</h3>
<p>Overlay Seurat clusters on the expression plot:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot "EPCAM" expression with cluster overlay</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ImageBinPlot</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>, </span>
<span>  feature <span class="op">=</span> <span class="st">"EPCAM"</span>, </span>
<span>  group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>, </span>
<span>  bin_size <span class="op">=</span> <span class="fl">10</span>, </span>
<span>  max_quantile <span class="op">=</span> <span class="st">"q75"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"expression"</span>,</span>
<span>  ident_alpha <span class="op">=</span> <span class="fl">0.3</span>, </span>
<span>  ident_pointsize <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  feature_on_top <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">ggsave</span><span class="op">(</span><span class="st">"EPCAM_with_clusters.pdf"</span>, <span class="va">p</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-4-filtered-identity-overlay">Example 4: Filtered Identity Overlay<a class="anchor" aria-label="anchor" href="#example-4-filtered-identity-overlay"></a>
</h3>
<p>Show only specific clusters:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Overlay only cluster "0" on "EPCAM"</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ImageBinPlot</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>, </span>
<span>  feature <span class="op">=</span> <span class="st">"EPCAM"</span>, </span>
<span>  group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>, </span>
<span>  filter_ident <span class="op">=</span> <span class="st">"0"</span>, </span>
<span>  bin_size <span class="op">=</span> <span class="fl">10</span>, </span>
<span>  max_quantile <span class="op">=</span> <span class="st">"q75"</span>, </span>
<span>  type <span class="op">=</span> <span class="st">"expression"</span>,</span>
<span>  ident_alpha <span class="op">=</span> <span class="fl">0.8</span>, </span>
<span>  feature_on_top <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">ggsave</span><span class="op">(</span><span class="st">"EPCAM_cluster0.pdf"</span>, <span class="va">p</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-5-batch-processing-for-a-single-object">Example 5: Batch Processing for a Single Object<a class="anchor" aria-label="anchor" href="#example-5-batch-processing-for-a-single-object"></a>
</h3>
<p>Generate plots for multiple genes:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EPCAM"</span>, <span class="st">"TP63"</span>, <span class="st">"GeneX"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span><span class="st">"batch_plots.pdf"</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">gene</span> <span class="kw">in</span> <span class="va">genes</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ImageBinPlot</span><span class="op">(</span></span>
<span>    <span class="va">obj</span>, </span>
<span>    feature <span class="op">=</span> <span class="va">gene</span>, </span>
<span>    bin_size <span class="op">=</span> <span class="fl">10</span>, </span>
<span>    max_quantile <span class="op">=</span> <span class="st">"q75"</span>, </span>
<span>    type <span class="op">=</span> <span class="st">"expression"</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-6-plotting-multiple-fields-of-view-fovs">Example 6: Plotting Multiple Fields of View (FOVs)<a class="anchor" aria-label="anchor" href="#example-6-plotting-multiple-fields-of-view-fovs"></a>
</h3>
<p>Generate plots for several FOVs using <code>ImageBinPlotFOVs</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate plots for all FOVs in the object with same scale</span></span>
<span><span class="va">p_fovs</span> <span class="op">&lt;-</span> <span class="fu">ImageBinPlotFOVs</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>, </span>
<span>  feature <span class="op">=</span> <span class="st">"EPCAM"</span>, </span>
<span>  bin_size <span class="op">=</span> <span class="fl">10</span>, </span>
<span>  max_quantile <span class="op">=</span> <span class="st">"q75"</span>,</span>
<span>  same_scale <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">ggsave</span><span class="op">(</span><span class="st">"EPCAM_all_FOVs.pdf"</span>, <span class="va">p_fovs</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-7-multi-object-plotting">Example 7: Multi-Object Plotting<a class="anchor" aria-label="anchor" href="#example-7-multi-object-plotting"></a>
</h3>
<p>Combine plots for multiple spatial transcriptomics objects:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assuming you have two Seurat objects: obj1 and obj2</span></span>
<span><span class="va">p_objects</span> <span class="op">&lt;-</span> <span class="fu">ImageBinPlotObjects</span><span class="op">(</span></span>
<span>  obj_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>obj1 <span class="op">=</span> <span class="va">obj1</span>, obj2 <span class="op">=</span> <span class="va">obj2</span><span class="op">)</span>, </span>
<span>  feature <span class="op">=</span> <span class="st">"EPCAM"</span>, </span>
<span>  bin_size <span class="op">=</span> <span class="fl">10</span>, </span>
<span>  max_quantile <span class="op">=</span> <span class="st">"q75"</span>,</span>
<span>  same_scale <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">ggsave</span><span class="op">(</span><span class="st">"EPCAM_multi_object.pdf"</span>, <span class="va">p_objects</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h2>
<ul>
<li>Ensure your Seurat object(s) contain the required spatial data (centroids for expression or coordinate data for molecules).</li>
<li>Adjust <code>max_quantile</code> to fine-tune color scaling.</li>
<li>The script is designed with Xenium data in mind but can be adapted for other spatial data formats.</li>
</ul>
</div>
<div class="section level2">
<h2 id="function-details">Function Details<a class="anchor" aria-label="anchor" href="#function-details"></a>
</h2>
<div class="section level3">
<h3 id="spatial-binning-plots">Spatial Binning Plots<a class="anchor" aria-label="anchor" href="#spatial-binning-plots"></a>
</h3>
<p>Visualize spatial transcriptomics data by creating binning plots for features (genes or molecules) in a Seurat object.</p>
<div class="section level4">
<h4 id="imagebinplot-1">
<code>ImageBinPlot</code><a class="anchor" aria-label="anchor" href="#imagebinplot-1"></a>
</h4>
<p>Creates a spatial binning plot for a specified feature (gene or molecule) in a Seurat object.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ImageBinPlot</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  <span class="va">feature</span>,</span>
<span>  group.by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x_col <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>  y_col <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  fov <span class="op">=</span> <span class="fu">Images</span><span class="op">(</span><span class="va">obj</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  x_min <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x_max <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_min <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_max <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bin_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  max_multiplier <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  max_quantile <span class="op">=</span> <span class="st">"q75"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"expression"</span>,</span>
<span>  assay <span class="op">=</span> <span class="st">"Xenium"</span>,</span>
<span>  layer <span class="op">=</span> <span class="st">"count"</span>,</span>
<span>  palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"viridis"</span>, <span class="st">"inferno"</span>, <span class="st">"magma"</span>, <span class="st">"plasma"</span>, <span class="st">"cividis"</span>, <span class="st">"mako"</span>, <span class="st">"rocket"</span>, <span class="st">"turbo"</span><span class="op">)</span>,</span>
<span>  palette_begin <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  palette_end <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ident_alpha <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  ident_pointsize <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  filter_ident <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  feature_on_top <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  flip_y <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level5">
<h5 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a>
</h5>
<p><code>obj</code><br>
A Seurat object containing spatial transcriptomics data.</p>
<p><code>feature</code><br>
Character string specifying the gene or feature to visualize.</p>
<p><code>group.by</code><br>
Optional character string; column name in the Seurat object for identity overlay (e.g., cell type or cluster). Default is <code>NULL</code>.</p>
<p><code>x_col</code><br>
Character string specifying the column name for x-coordinate values. Default is <code>"x"</code>.</p>
<p><code>y_col</code><br>
Character string specifying the column name for y-coordinate values. Default is <code>"y"</code>.</p>
<p><code>fov</code><br>
Character string specifying the field of view to visualize; defaults to the first available FOV in the object (<code>Images(obj)[[1]]</code>).</p>
<p><code>x_min</code><br>
Numeric; minimum x-coordinate limit. If <code>NULL</code>, automatically set from the FOV’s centroid range.</p>
<p><code>x_max</code><br>
Numeric; maximum x-coordinate limit. If <code>NULL</code>, automatically set from the FOV’s centroid range.</p>
<p><code>y_min</code><br>
Numeric; minimum y-coordinate limit. If <code>NULL</code>, automatically set from the FOV’s centroid range.</p>
<p><code>y_max</code><br>
Numeric; maximum y-coordinate limit. If <code>NULL</code>, automatically set from the FOV’s centroid range.</p>
<p><code>bin_size</code><br>
Numeric; size of each spatial bin (in micrometers). Default is <code>10</code>.</p>
<p><code>max_multiplier</code><br>
Numeric; deprecated multiplier for color scale. Use <code>max_quantile</code> instead. Default is <code>NULL</code>.</p>
<p><code>min</code><br>
Numeric; minimum value for the color scale. Default is <code>0</code>.</p>
<p><code>max_quantile</code><br>
Character string (e.g., <code>"q75"</code>) specifying the quantile to determine the maximum value for the color scale from binned data. Default is <code>"q75"</code>.</p>
<p><code>type</code><br>
Character string specifying the type of data to plot; either <code>"expression"</code> (cell-based) or <code>"molecule"</code> (individual transcript counts). Default is <code>"expression"</code>. When <code>type = "expression"</code> resulting average values per bin, while <code>type = "molecule"</code> values are count of molecules per bin.</p>
<p><code>assay</code><br>
Character string specifying the assay to use for data extraction from the Seurat object. Default is <code>"Xenium"</code>.</p>
<p><code>layer</code><br>
Character string specifying the data layer within the assay to use (e.g., <code>"count"</code>). Default is <code>"count"</code>.</p>
<p><code>palette</code><br>
Character vector of color palette options for visualization (e.g., <code>"viridis"</code>, <code>"inferno"</code>, etc.). Default is <code>c("viridis", "inferno", "magma", "plasma", "cividis", "mako", "rocket", "turbo")</code>.</p>
<p><code>palette_begin</code><br>
Numeric; start position of the selected color palette. Default is <code>0</code>.</p>
<p><code>palette_end</code><br>
Numeric; end position of the selected color palette. Default is <code>1</code>.</p>
<p><code>ident_alpha</code><br>
Numeric; transparency level for the identity overlay points, between 0 and 1. Default is <code>0.3</code>.</p>
<p><code>ident_pointsize</code><br>
Numeric; point size for the identity overlay. Default is <code>1</code>.</p>
<p><code>filter_ident</code><br>
Optional vector; filter to include only specific identities from <code>group.by</code>. Default is <code>NULL</code>.</p>
<p><code>feature_on_top</code><br>
Logical; if <code>TRUE</code>, the feature layer (binned data) is rendered on top of the identity overlay. Default is <code>TRUE</code>.</p>
<p><code>flip_y</code> Logical; Whether to flip the y-axis. Default is <code>TRUE</code>.</p>
</div>
<div class="section level5">
<h5 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a>
</h5>
<p>A ggplot object representing the spatial binning plot.</p>
<hr>
</div>
</div>
<div class="section level4">
<h4 id="imagebinplotfovs">
<code>ImageBinPlotFOVs</code><a class="anchor" aria-label="anchor" href="#imagebinplotfovs"></a>
</h4>
<p>Generates bin plots for multiple fields of view (FOVs) in a Seurat object, with an option to enforce the same scale across FOVs.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ImageBinPlotFOVs</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  <span class="va">feature</span>,</span>
<span>  group.by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fovs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bin_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  min <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  max_quantile <span class="op">=</span> <span class="st">"q75"</span>,</span>
<span>  x_min <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x_max <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_min <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_max <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x_col <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>  y_col <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"expression"</span>,</span>
<span>  assay <span class="op">=</span> <span class="st">"Xenium"</span>,</span>
<span>  layer <span class="op">=</span> <span class="st">"count"</span>,</span>
<span>  ident_alpha <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  ident_pointsize <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"viridis"</span>, <span class="st">"inferno"</span>, <span class="st">"magma"</span>, <span class="st">"plasma"</span>, <span class="st">"cividis"</span>, <span class="st">"mako"</span>, <span class="st">"rocket"</span>, <span class="st">"turbo"</span><span class="op">)</span>,</span>
<span>  palette_begin <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  palette_end <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  filter_ident <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  feature_on_top <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  same_scale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ncol <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level5">
<h5 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a>
</h5>
<p><code>obj</code><br>
A Seurat object containing spatial transcriptomics data.</p>
<p><code>feature</code><br>
Character string specifying the gene or feature to be visualized.</p>
<p><code>group.by</code><br>
Optional character string; column for identity overlay. Default is <code>NULL</code>.</p>
<p><code>fovs</code><br>
Vector of FOV names to plot. If <code>NULL</code>, defaults to all available FOVs in the object (<code>Images(obj)</code>).</p>
<p><code>bin_size</code><br>
Numeric; size of spatial bins (in micrometers). Default is <code>10</code>.</p>
<p><code>min</code><br>
Numeric; minimum value for the color scale. Default is <code>0</code>.</p>
<p><code>max_quantile</code><br>
Character string (e.g., <code>"q75"</code>) to determine the maximum value for the color scale. Default is <code>"q75"</code>.</p>
<p><code>x_min</code><br>
Numeric; optional minimum x-coordinate. Derived from data if <code>NULL</code>.</p>
<p><code>x_max</code><br>
Numeric; optional maximum x-coordinate. Derived from data if <code>NULL</code>.</p>
<p><code>y_min</code><br>
Numeric; optional minimum y-coordinate. Derived from data if <code>NULL</code>.</p>
<p><code>y_max</code><br>
Numeric; optional maximum y-coordinate. Derived from data if <code>NULL</code>.</p>
<p><code>x_col</code><br>
Character string specifying the column name for x-coordinate values. Default is <code>"x"</code>.</p>
<p><code>y_col</code><br>
Character string specifying the column name for y-coordinate values. Default is <code>"y"</code>.</p>
<p><code>type</code><br>
Character string; type of data to plot, either <code>"expression"</code> or <code>"molecule"</code>. Default is <code>"expression"</code>.</p>
<p><code>assay</code><br>
Character string; assay to use for data extraction. Default is <code>"Xenium"</code>.</p>
<p><code>layer</code><br>
Character string; data layer to use for extraction. Default is <code>"count"</code>.</p>
<p><code>ident_alpha</code><br>
Numeric; transparency level for identity overlay points, between 0 and 1. Default is <code>0.3</code>.</p>
<p><code>ident_pointsize</code><br>
Numeric; size of identity overlay points. Default is <code>1</code>.</p>
<p><code>palette</code><br>
Character vector of color palette options for plotting. Default is <code>c("viridis", "inferno", "magma", "plasma", "cividis", "mako", "rocket", "turbo")</code>.</p>
<p><code>palette_begin</code><br>
Numeric; start point for the color palette. Default is <code>0</code>.</p>
<p><code>palette_end</code><br>
Numeric; end point for the color palette. Default is <code>1</code>.</p>
<p><code>filter_ident</code><br>
Optional vector; filter to include only selected identities. Default is <code>NULL</code>.</p>
<p><code>feature_on_top</code><br>
Logical; if <code>TRUE</code>, the binned feature layer is drawn on top of the identity layer. Default is <code>TRUE</code>.</p>
<p><code>same_scale</code><br>
Logical; if <code>TRUE</code>, forces all FOV plots to use the same color scale. Default is <code>FALSE</code>.</p>
<p><code>ncol</code><br>
Numeric; optional number of columns when arranging multiple FOV plots in a grid. Default is <code>NULL</code>.</p>
</div>
<div class="section level5">
<h5 id="value-1">Value<a class="anchor" aria-label="anchor" href="#value-1"></a>
</h5>
<p>A patchwork ggplot object combining bin plots for all specified FOVs.</p>
<hr>
</div>
</div>
<div class="section level4">
<h4 id="imagebinplotobjects">
<code>ImageBinPlotObjects</code><a class="anchor" aria-label="anchor" href="#imagebinplotobjects"></a>
</h4>
<p>Creates spatial binning plots for multiple Seurat objects, optionally across multiple FOVs, with an option for uniform scaling.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ImageBinPlotObjects</span><span class="op">(</span></span>
<span>  <span class="va">obj_list</span>,</span>
<span>  <span class="va">feature</span>,</span>
<span>  group.by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fovs_list <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bin_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  min <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  max_quantile <span class="op">=</span> <span class="st">"q75"</span>,</span>
<span>  x_min <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x_max <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_min <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_max <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x_col <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>  y_col <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"expression"</span>,</span>
<span>  assay <span class="op">=</span> <span class="st">"Xenium"</span>,</span>
<span>  layer <span class="op">=</span> <span class="st">"count"</span>,</span>
<span>  ident_alpha <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  ident_pointsize <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"viridis"</span>, <span class="st">"inferno"</span>, <span class="st">"magma"</span>, <span class="st">"plasma"</span>, <span class="st">"cividis"</span>, <span class="st">"mako"</span>, <span class="st">"rocket"</span>, <span class="st">"turbo"</span><span class="op">)</span>,</span>
<span>  palette_begin <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  palette_end <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  filter_ident <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  feature_on_top <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  same_scale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ncol <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level5">
<h5 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a>
</h5>
<p><code>obj_list</code><br>
A named list of Seurat objects to be plotted.</p>
<p><code>feature</code><br>
Character string; the gene or feature to visualize across objects.</p>
<p><code>group.by</code><br>
Optional character string; grouping variable for identity overlay across objects. Default is <code>NULL</code>.</p>
<p><code>fovs_list</code><br>
List of FOV vectors corresponding to each object. If <code>NULL</code>, defaults to all FOVs from each object via <code>Images(.x)</code>.</p>
<p><code>bin_size</code><br>
Numeric; size of the spatial bins (in micrometers). Default is <code>10</code>.</p>
<p><code>min</code><br>
Numeric; minimum value for the color scale. Default is <code>0</code>.</p>
<p><code>max_quantile</code><br>
Character string (e.g., <code>"q75"</code>) to determine the maximum value for the color scale. Default is <code>"q75"</code>.</p>
<p><code>x_min</code><br>
Numeric; optional minimum x-coordinate limit. Determined per object/FOV if <code>NULL</code>.</p>
<p><code>x_max</code><br>
Numeric; optional maximum x-coordinate limit. Determined per object/FOV if <code>NULL</code>.</p>
<p><code>y_min</code><br>
Numeric; optional minimum y-coordinate limit. Determined per object/FOV if <code>NULL</code>.</p>
<p><code>y_max</code><br>
Numeric; optional maximum y-coordinate limit. Determined per object/FOV if <code>NULL</code>.</p>
<p><code>x_col</code><br>
Character string; column name for x-coordinate values. Default is <code>"x"</code>.</p>
<p><code>y_col</code><br>
Character string; column name for y-coordinate values. Default is <code>"y"</code>.</p>
<p><code>type</code><br>
Character string; data type to visualize, either <code>"expression"</code> or <code>"molecule"</code>. Default is <code>"expression"</code>.</p>
<p><code>assay</code><br>
Character string; assay used for data extraction in each Seurat object. Default is <code>"Xenium"</code>.</p>
<p><code>layer</code><br>
Character string; data layer within the assay to use. Default is <code>"count"</code>.</p>
<p><code>ident_alpha</code><br>
Numeric; transparency level for identity overlay points, between 0 and 1. Default is <code>0.3</code>.</p>
<p><code>ident_pointsize</code><br>
Numeric; size of the identity overlay points. Default is <code>1</code>.</p>
<p><code>palette</code><br>
Character vector of color palette options for plotting. Default is <code>c("viridis", "inferno", "magma", "plasma", "cividis", "mako", "rocket", "turbo")</code>.</p>
<p><code>palette_begin</code><br>
Numeric; start point for the color palette. Default is <code>0</code>.</p>
<p><code>palette_end</code><br>
Numeric; end point for the color palette. Default is <code>1</code>.</p>
<p><code>filter_ident</code><br>
Optional vector; filter to restrict which identities to plot. Default is <code>NULL</code>.</p>
<p><code>feature_on_top</code><br>
Logical; if <code>TRUE</code>, the binned feature layer is drawn over the identity overlay. Default is <code>TRUE</code>.</p>
<p><code>same_scale</code><br>
Logical; if <code>TRUE</code>, applies a uniform color scale across all objects and their FOVs. Default is <code>FALSE</code>.</p>
<p><code>ncol</code><br>
Numeric; optional number of columns when arranging combined plots in a grid. Default is <code>NULL</code>.</p>
</div>
<div class="section level5">
<h5 id="value-2">Value<a class="anchor" aria-label="anchor" href="#value-2"></a>
</h5>
<p>A patchwork ggplot object combining bin plots across all specified objects and FOVs.</p>
<hr>
<p>This format aligns with the R documentation style you provided, including sections for function description, arguments, and return value, while maintaining clarity and consistency. Let me know if you’d like further adjustments!</p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>Submit issues or pull requests to improve functionality or add features.</p>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>MIT License - see LICENSE for details.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>`use_mit_license()`</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ImageBinPlot</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Simon Mo <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/YOUR-ORCID-ID" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Simon Mo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
